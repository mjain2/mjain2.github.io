<!--REAL-->
<!DOCTYPE html>
<html>
  <head>
    <title>FoodFairies</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0;
        padding: 0;
		width: 100%;
     }
	#container { 
		padding: 0px;
		margin: 0px;
		width: 100%;
		position: static;
	}	
	
	.heads {
		border: 0px;
		padding:0px;
		width: 31%;
		height: 100%;
		margin: 0px;
		float: left;
		position: static;

	}	
	
	.button {
		background-color: #FFC0CB;
		font-family:'Verdana';
		padding: 10px;
		height:40px;
		margin: 140px 40px 0px 40px;
		width:600px;
		position: static;
		
	}
	.logo {
		padding: 10px;
		position: static;

	}

    </style>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAyMxCEgRgsRd_ZR1rvylGbEEUcBeJl6dI"></script>
</head>
<body onload="initialize()">
	<!--header-->
	<center>
	<div id="container">
		<div class="heads"><button class="button" onclick="addPoint()" style="float:left"><b>Found a homeless person? Click to enter your current location.</b></button></div>
		<div class="heads"><img src="FoodFairies.png" style="width: 50%;" class="logo"></div>
		<div class="heads"><button class="button" onclick="self.location='http://www.gps-coordinates.net/'" style="float:right"><b>Click here to find your coordinates.</b></button></div>
	</div>
	</center>
	
	<div id="map-canvas"></div>

	<script type="text/javascript">
	var map;
	function initialize() {
	//add mapp:
		map = new google.maps.Map(document.getElementById('map-canvas'), {
			zoom: 3,
			center: new google.maps.LatLng(0, 0),
			mapTypeId: google.maps.MapTypeId.ROADMAP
	});
	}
	//GEOLOCATION------------------------------------------------------------------------------------
	// Try HTML5 geolocation
	/*
		var pos;
	
		if(navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position) {
			pos = new google.maps.LatLng(position.coords.latitude,
										   position.coords.longitude);
			console.log(pos);
			console.log(pos[0]); // undefined
			var infowindow = new google.maps.InfoWindow({
				map: map,
				position: pos,
				content: 'Current location.'
			});

			map.setCenter(pos);
		}, function() {
		  handleNoGeolocation(true);
		});
		} else {
		// Browser doesn't support Geolocation
			handleNoGeolocation(false);
		}
		
		return pos;
	}

	function handleNoGeolocation(errorFlag) {
	  if (errorFlag) {
		var content = 'Error: The Geolocation service failed.';
	  } else {
		var content = 'Error: Your browser doesn\'t support geolocation.';
	  }

	  var options = {
		map: map,
		position: new google.maps.LatLng(60, 105),
		content: content
	  };

	  var infowindow = new google.maps.InfoWindow(options);
	  map.setCenter(options.position);
	}

	google.maps.event.addDomListener(window, 'load', initialize);
	*/
		
	//POINTS-----------------------------------------------------------------------
		
	var locations = [
		//['hungry', 34.0093515, -118.49746820000001, 0],
		//['needs blanket', 38, -119, 1],
	];	
	var lat,lng;
	
	function showPosition(position) {
	  lat = position.coords.latitude;
	  console.log(lat);
	  lng = position.coords.longitude;
	  console.log(lng);
	  map.setCenter(new google.maps.LatLng(lat, lng)); 
	  console.log("SHOW POSITION: " + lat + "  " + lng);
	}

	function getLocation() {
		if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(showPosition);
			} else {
				alert("Geolocation is not supported by this browser.");
			}
		console.log(lat + '' + lng);
		return [lat,lng];
	}
	//ADD POINT-------------------------------------------------------------------------
		function addPoint() {
			//var lat = Number(prompt("Please enter latitude", "latitude"));
			//var loong = Number(prompt("Please enter longitude", "longitude"));
		//	var condition = prompt("What condition is the homeless person in?", "no blanket, need food");
			var infowindow = new google.maps.InfoWindow();
			var coordinates = getLocation();
			lat = coordinates[0];
			lng = coordinates[1];
			var marker,i; //currentId, uniqueId, id;
			var condition = prompt("What condition is the homeless person in?", "no blanket, need food");
			locations.push([condition, lat, lng, i+1]);
			alert(locations[0]);
			//places points:
			for (i = 0; i < locations.length; i++) {  
				marker = new google.maps.Marker({ //makes a new marker
				position: new google.maps.LatLng(locations[i][1], locations[i][2]), //sets position to lat and lng values
				map: map
			});

			google.maps.event.addListener(marker, 'click', (function(marker, i) {
				return function() {
				  infowindow.setContent(locations[i][0]);
				  infowindow.open(map, marker);
				}
			})(marker, i));
			}
			
			
			
			

			
			
			
			
			/*		
			var infowindow = new google.maps.InfoWindow();
			
			var marker, i; //currentId, uniqueId, id;
				
			//places points:
			for (i = 0; i < locations.length; i++) {  
				marker = new google.maps.Marker({ //makes a new marker
				position: new google.maps.LatLng(locations[i][1], locations[i][2]), //sets position to lat and lng values
				map: map
			});

			google.maps.event.addListener(marker, 'click', (function(marker, i) {
				return function() {
				  infowindow.setContent(locations[i][0]);
				  infowindow.open(map, marker);
				}
			})(marker, i));
			}
			*/
		}


		

  </script>
  </div>
  </body>
</html>